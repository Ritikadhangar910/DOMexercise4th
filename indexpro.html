<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
      crossorigin="anonymous"
    />

    <title>Hello, world!</title>
  </head>
  <body>
    <div class="container">
      <h1>Fill form</h1>
      <form id="form">
        <div class="form-group row">
          <label for="expense" class="col-sm-3 col-form-label">Name</label>
          <div class="col-sm-8">
            <input type="text" class="form-control" id="expense" />
          </div>
        </div>
        <div class="form-group row">
          <label for="discription" class="col-sm-3 col-form-label">Email</label>
          <div class="col-sm-8">
            <input type="email" class="form-control" id="discription" />
          </div>
        </div>
        <div class="form-group row">
          <label for="inputState" class="col-sm-3 col-form-label"
            >Phone Number</label
          >
          <div class="col-sm-8">
            <input type="text" class="form-control" id="inputState" />
          </div>
        </div>
        <div class="form-group row">
          <div class="col-sm-10">
            <button type="submit" class="btn btn-primary" id="btn">
              Summit
            </button>
          </div>
        </div>
      </form>
    </div>

    <!-- Include jQuery first, then Bootstrap's JavaScript -->
    <script
      src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
      crossorigin="anonymous"
    ></script>
  </body>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.4.0/axios.min.js"></script>

  <script>
    window.addEventListener("DOMContentLoaded", (e) => {
      e.preventDefault();
      axios
        .get("https://crudcrud.com/api/0a0eb1e5cfd14be690342abfc53bb64b/mydata")
        .then((res) => {
          const datas = res.data;
          for (const data of datas) {
            showinli(data);
          }
        })
        .catch((err) => {
          console.log(err);
          document.body.innerHTML += `<h2>Error Found</h2>`;
        });
    });

    let btn = document.getElementById("btn");
    btn.addEventListener("click", (e) => {
      e.preventDefault();
      let valexpense = document.getElementById("expense").value;
      let valdesp = document.getElementById("discription").value;
      let valcato = document.getElementById("inputState").value;
      const obj = {
        expense: valexpense,
        description: valdesp,
        catory: valcato,
      };
      axios
        .post(
          "https://crudcrud.com/api/0a0eb1e5cfd14be690342abfc53bb64b/mydata",
          obj
        )
        .then((res) => {
          showinli(res.data);
          console.log(res);
        })
        .catch((err) => {
          console.log(err);
          document.body.innerHTML += `<h2>Error Found</h2>`;
        });
    });

    function showinli(myobj) {
      const lielem = document.createElement("li");
      lielem.textContent = `${myobj.expense} ${myobj.description} ${myobj.catory}`;
      lielem.setAttribute("id", `${myobj._id}`);
      const form = document.getElementById("form");
      const delbtn = document.createElement("button");
      delbtn.textContent = "delete";
      delbtn.style.marginLeft = "5px";
      const editbtn = document.createElement("button");
      editbtn.textContent = "edit";
      editbtn.style.marginLeft = "5px";
      lielem.appendChild(delbtn);
      lielem.appendChild(editbtn);
      function removeElem(param) {
        const getid = document.getElementById(param);
        form.removeChild(getid);
      }
      delbtn.addEventListener("click", (e) => {
        e.preventDefault();
        // console.log(myobj._id);
        axios
          .delete(
            `https://crudcrud.com/api/0a0eb1e5cfd14be690342abfc53bb64b/mydata/${myobj._id}`
          )
          .then((res) => {
            removeElem(myobj._id);
          })
          .catch((err) => {
            console.log(err);
          });
      });
      editbtn.addEventListener("click", (e) => {
        e.preventDefault();
        form.removeChild(lielem);
        document.getElementById("expense").value = myobj.expense;
        document.getElementById("discription").value = myobj.description;
        document.getElementById("inputState").value = myobj.catory;
      });
      form.appendChild(lielem);
    }
  </script>
</html>
